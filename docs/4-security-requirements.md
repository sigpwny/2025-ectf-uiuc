# Security Requirements

Below, we summarize how we address the Security Requirements in our design.

## Security Requirement 1
> "An attacker should not be able to decode TV frames without a Decoder that has a valid, active subscription to that channel."

By using Ascon-128 with nonces, we can validate the integrity of the picture metadata (including channel ID and timestamp) by decrypting the outer layer. By deriving a picture key using a channel secret that can only be shared via a subscription, a Decoder cannot decode a picture without a proper subscription. Confidentiality of the frame is, of course, also provided by Ascon-128.

A subscription is specific to a Decoder, as it is encrypted using a subscription key which is derived from a Decoder's ID. Only the Decoder with the matching subscription key can decrypt the subscription and obtain the channel secret. Thus, a Decoder can only decode frames for channels it has an active subscription for.

## Security Requirement 2
> "The Decoder should only decode valid TV frames generated by the Satellite System the Decoder was provisioned for."

TV picture frames are internally encrypted using a key that is unique to the channel and timestamp and derived from a channel secret. The channel secret is unique to the channel and can only be obtained by a Decoder through a valid subscription. Since subscriptions are unique to a Decoder, a Decoder can only obtain channel secrets for channels it has an active subscription for. Thus, a Decoder can only decrypt frames for channels it has an active subscription for.

## Security Requirement 3
> "The Decoder should only decode frames with strictly monotonically increasing timestamps."

The Decoder maintains a global timestamp counter that is only updated when a frame is successfully decoded. If a frame is received with a timestamp that is less than or equal to the current timestamp, the frame is rejected. This ensures that frames are only decoded in an increasing order.

## Security Requirement 4
> "The Decoder's operations should be resistant to side-channel analysis, fault injection, and other physical attacks."

- We implement random delays around I/O operations to make timing and fault injection attacks more difficult, since glitches need to be precisely timed.
- The use of random nonces and derived keys also helps protect against power analysis attacks.
- We implement Zeroization to ensure that sensitive data is not left in memory after it is no longer needed.
- We implement the Arm memory protection unit (MPU) to prevent unauthorized access to memory regions, as well as to prevent code execution from data regions.