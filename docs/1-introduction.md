# Introduction

This document describes UIUC's implementation of a secure satellite TV system for the MITRE eCTF 2025 competition.

## Competition Overview

eCTF 2025 simulates a satellite network through the supplied host tools provided by the competition organizers. These host tools simulate the uplink, satellite, and downlink components. These components are out-of-scope for implementation and teams instead focus on implementing the Encoder and Decoder components, as well as the build system for these components.

- **Encoder**: Transforms input data streams into encoded streams, which is sent to the uplink, then to the satellite. The satellite then transmits one-way to the receiver, which passes the data to the Decoder.
- **Decoder**: Receives encoded streams from the receiver, decodes them, and outputs the original data streams.

The Encoder is meant to run on any standard operating system as its interface is required to be compatible with the host tools written in Python. The Decoder runs on Analog Devices' MAX78000FTHR development board, which features the MAX78000 microcontroller.

### Security Requirements

Below are the Security Requirements (SRs) provided by the competition organizers, which are meant to defend against the Attack Scenarios.

- **SR1**: An attacker should not be able to decode TV frames without a Decoder that has a valid, active subscription to that channel.
- **SR2**: The Decoder should only decode valid TV frames generated by the Satellite System the Decoder was provisioned for.
- **SR3**: The Decoder should only decode frames with strictly monotonically increasing timestamps.

Due to the embedded systems focus of the competition, we believe that it is necessary to introduce an additional security requirement to defend against hardware attacks:

- **SR4**: The Decoder's operations should be resistant to side-channel analysis, fault injection, and other physical attacks.

### Attack Scenarios

The following Attack Scenarios are considered by the competition organizers. Successful attacks against these scenarios result in a flag, which is a string in the form of `ectf{...}`.

- **AS1** - Expired Subscription: Read frames from a channel you have an expired subscription for.
- **AS2** - Pirated Subscription: Read frames from a channel you have a pirated subscription for (i.e. a subscription that was intended for another Decoder).
- **AS3** - No Subscription: Read frames from a channel you have no subscription for.
- **AS4** - Recording Playback: Read frames from a recorded channel you currently have a subscription for, but didn't at the time of the recording.
- **AS5** - Pesky Neighbor: Spoof the signal of the satellite to cause your neighbor's decoder to decode your frames instead.

## Design Overview

To effectively address the Security Requirements and Attack Scenarios, we made the following design decisions.

### Rust

Rust is a systems programming language that provides memory safety, thread safety, and other features that make it well-suited for embedded systems development. Rust's strong type system and ownership model helps prevent common programming errors that can lead to security vulnerabilities, such as buffer overflows.

We decided to implement both the Encoder and Decoder in Rust to take advantage of these features. To support the required Python interface for the Encoder, we used PyO3 to generate Python bindings for our Rust code and Maturin to build and pre-compile wheel files for local installation. The performance of our Encoder is also much improved by using Rust, as it is able to encode frames much faster than a Python implementation.

The MAX78000 microcontroller is a dual-core MCU with an Arm Cortex-M4 and a RISC-V core. We primarily use the CM4 core for our implementation, and leave the RISC-V core disabled. Arm targets are well-supported by Rust; however, the MAX78000 lacks a widely-supported Rust Hardware Abstraction Layer (HAL). We had previously worked with the MAX78000 in Rust before, so we decided to open source our own HAL implementation as the [max7800x-hal](https://github.com/sigpwny/max7800x-hal) crate. Our primary hope in publishing our HAL is that more teams will adopt Rust in their own designs.

### Authenticated Encryption

We use the [Ascon-128](https://ascon.iaik.tugraz.at/) authenticated encryption scheme to protect the confidentiality and integrity of encoded streams and channel subscription updates. Ascon-128 is a lightweight authenticated encryption scheme that is well-suited for embedded systems, along with countermeasures against side-channel attacks.
